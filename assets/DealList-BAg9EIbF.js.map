{"version":3,"file":"DealList-BAg9EIbF.js","sources":["../../node_modules/ra-core/dist/controller/input/useReferenceArrayInputController.js","../../src/components/admin/autocomplete-array-input.tsx","../../src/components/admin/reference-array-input.tsx","../../src/components/admin/number-input.tsx","../../src/components/atomic-crm/deals/DealCard.tsx","../../src/components/atomic-crm/deals/DealArchivedList.tsx","../../src/components/ui/visually-hidden.tsx","../../src/components/atomic-crm/deals/DealInputs.tsx","../../src/components/atomic-crm/deals/DealCreate.tsx","../../src/components/atomic-crm/deals/DealEdit.tsx","../../src/components/atomic-crm/deals/DealEmpty.tsx","../../src/components/atomic-crm/deals/DealColumn.tsx","../../src/components/atomic-crm/deals/stages.ts","../../src/components/atomic-crm/deals/DealListContent.tsx","../../src/components/atomic-crm/deals/OnlyMineInput.tsx","../../src/components/atomic-crm/deals/DealList.tsx"],"sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport { useCallback, useMemo } from 'react';\nimport { useFormContext, useWatch } from 'react-hook-form';\nimport { useGetList, useGetManyAggregate } from \"../../dataProvider/index.js\";\nimport { useReferenceParams } from \"./useReferenceParams.js\";\nimport { useWrappedSource } from \"../../core/index.js\";\n/**\n * Prepare data for the ReferenceArrayInput components\n *\n * @example\n *\n * const { allChoices, availableChoices, selectedChoices, error, isFetching, isLoading, isPending } = useReferenceArrayInputController({\n *      record: { referenceIds: ['id1', 'id2']};\n *      reference: 'reference';\n *      resource: 'resource';\n *      source: 'referenceIds';\n * });\n *\n * @param {Object} props\n * @param {Object} props.record The current resource record\n * @param {string} props.reference The linked resource name\n * @param {string} props.resource The current resource name\n * @param {string} props.source The key of the linked resource identifier\n *\n * @param {Props} props\n *\n * @return {Object} controllerProps Fetched data and callbacks for the ReferenceArrayInput components\n */\nexport var useReferenceArrayInputController = function (props) {\n    var _a;\n    var debounce = props.debounce, enableGetChoices = props.enableGetChoices, filter = props.filter, _b = props.page, initialPage = _b === void 0 ? 1 : _b, _c = props.perPage, initialPerPage = _c === void 0 ? 25 : _c, _d = props.sort, initialSort = _d === void 0 ? { field: 'id', order: 'DESC' } : _d, _e = props.queryOptions, queryOptions = _e === void 0 ? {} : _e, reference = props.reference, source = props.source;\n    var getValues = useFormContext().getValues;\n    var finalSource = useWrappedSource(source);\n    // When we change the defaultValue of the child input using react-hook-form resetField function,\n    // useWatch does not seem to get the new value. We fallback to getValues to get it.\n    var value = (_a = useWatch({ name: finalSource })) !== null && _a !== void 0 ? _a : getValues(finalSource);\n    var meta = queryOptions.meta, otherQueryOptions = __rest(queryOptions, [\"meta\"]);\n    /**\n     * Get the records related to the current value (with getMany)\n     */\n    var _f = useGetManyAggregate(reference, {\n        ids: value || EmptyArray,\n        meta: meta,\n    }, {\n        enabled: value != null && value.length > 0,\n    }), referenceRecords = _f.data, errorGetMany = _f.error, isLoadingGetMany = _f.isLoading, isFetchingGetMany = _f.isFetching, isPausedGetMany = _f.isPaused, isPendingGetMany = _f.isPending, isPlaceholderDataGetMany = _f.isPlaceholderData, refetchGetMany = _f.refetch;\n    var _g = useReferenceParams({\n        resource: reference,\n        page: initialPage,\n        perPage: initialPerPage,\n        sort: initialSort,\n        debounce: debounce,\n        filter: filter,\n    }), params = _g[0], paramsModifiers = _g[1];\n    // filter out not found references - happens when the dataProvider doesn't guarantee referential integrity\n    var finalReferenceRecords = referenceRecords\n        ? referenceRecords.filter(Boolean)\n        : [];\n    var isGetMatchingEnabled = enableGetChoices\n        ? enableGetChoices(params.filterValues)\n        : true;\n    var _h = useGetList(reference, {\n        pagination: {\n            page: params.page,\n            perPage: params.perPage,\n        },\n        sort: { field: params.sort, order: params.order },\n        filter: __assign(__assign({}, params.filter), filter),\n        meta: meta,\n    }, __assign({ retry: false, enabled: isGetMatchingEnabled, placeholderData: function (previousData) { return previousData; } }, otherQueryOptions)), matchingReferences = _h.data, total = _h.total, pageInfo = _h.pageInfo, errorGetList = _h.error, isLoadingGetList = _h.isLoading, isFetchingGetList = _h.isFetching, isPausedGetList = _h.isPaused, isPendingGetList = _h.isPending, isPlaceholderDataGetList = _h.isPlaceholderData, refetchGetMatching = _h.refetch;\n    // We merge the currently selected records with the matching ones, otherwise\n    // the component displaying the currently selected records may fail\n    var finalMatchingReferences = matchingReferences && matchingReferences.length > 0\n        ? mergeReferences(matchingReferences, finalReferenceRecords)\n        : finalReferenceRecords.length > 0\n            ? finalReferenceRecords\n            : matchingReferences;\n    var refetch = useCallback(function () {\n        refetchGetMany();\n        refetchGetMatching();\n    }, [refetchGetMany, refetchGetMatching]);\n    var currentSort = useMemo(function () { return ({\n        field: params.sort,\n        order: params.order,\n    }); }, [params.sort, params.order]);\n    return {\n        sort: currentSort,\n        allChoices: finalMatchingReferences,\n        availableChoices: matchingReferences,\n        selectedChoices: finalReferenceRecords,\n        displayedFilters: params.displayedFilters,\n        error: errorGetMany || errorGetList,\n        filter: filter,\n        filterValues: params.filterValues,\n        hideFilter: paramsModifiers.hideFilter,\n        isFetching: isFetchingGetMany || isFetchingGetList,\n        isLoading: isLoadingGetMany || isLoadingGetList,\n        isPaused: isPausedGetMany || isPausedGetList,\n        isPending: isPendingGetMany || isPendingGetList,\n        isPlaceholderData: isPlaceholderDataGetMany || isPlaceholderDataGetList,\n        page: params.page,\n        perPage: params.perPage,\n        refetch: refetch,\n        resource: reference,\n        setFilters: paramsModifiers.setFilters,\n        setPage: paramsModifiers.setPage,\n        setPerPage: paramsModifiers.setPerPage,\n        setSort: paramsModifiers.setSort,\n        showFilter: paramsModifiers.showFilter,\n        // we return source and not finalSource because child inputs (e.g. AutocompleteArrayInput) already call useInput and compute the final source\n        source: source,\n        total: total,\n        hasNextPage: pageInfo\n            ? pageInfo.hasNextPage\n            : total != null\n                ? params.page * params.perPage < total\n                : undefined,\n        hasPreviousPage: pageInfo ? pageInfo.hasPreviousPage : params.page > 1,\n        isFromReference: true,\n    };\n};\nvar EmptyArray = [];\n// concatenate and deduplicate two lists of records\nvar mergeReferences = function (ref1, ref2) {\n    var res = __spreadArray([], ref1, true);\n    var ids = ref1.map(function (ref) { return ref.id; });\n    ref2.forEach(function (ref) {\n        if (!ids.includes(ref.id)) {\n            ids.push(ref.id);\n            res.push(ref);\n        }\n    });\n    return res;\n};\n//# sourceMappingURL=useReferenceArrayInputController.js.map","import * as React from \"react\";\nimport { X } from \"lucide-react\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n  Command,\n  CommandGroup,\n  CommandItem,\n  CommandList,\n} from \"@/components/ui/command\";\nimport {\n  FormControl,\n  FormError,\n  FormField,\n  FormLabel,\n} from \"@/components/admin/form\";\nimport { Command as CommandPrimitive } from \"cmdk\";\nimport type { ChoicesProps, InputProps } from \"ra-core\";\nimport {\n  useChoices,\n  useChoicesContext,\n  useGetRecordRepresentation,\n  useInput,\n  useTranslate,\n  FieldTitle,\n  useEvent,\n} from \"ra-core\";\nimport { InputHelperText } from \"./input-helper-text\";\nimport { useCallback } from \"react\";\n\n/**\n * Form control that lets users choose multiple values from a list using a dropdown with autocompletion.\n *\n * This input allows editing array values with a searchable dropdown interface and displays selected items as removable badges.\n * Works seamlessly inside ReferenceArrayInput for editing many-to-many relationships.\n *\n * @see {@link https://marmelab.com/shadcn-admin-kit/docs/autocompletearrayinput/ AutocompleteArrayInput documentation}\n *\n * @example\n * import {\n *   Create,\n *   SimpleForm,\n *   AutocompleteArrayInput,\n *   ReferenceArrayInput,\n * } from '@/components/admin';\n *\n * const PostCreate = () => (\n *   <Create>\n *     <SimpleForm>\n *       <AutocompleteArrayInput\n *         source=\"tags\"\n *         choices={[\n *           { id: 'tech', name: 'Tech' },\n *           { id: 'news', name: 'News' },\n *           { id: 'lifestyle', name: 'Lifestyle' },\n *         ]}\n *       />\n *       <ReferenceArrayInput source=\"tag_ids\" reference=\"tags\">\n *         <AutocompleteArrayInput />\n *       </ReferenceArrayInput>\n *     </SimpleForm>\n *   </Create>\n * );\n */\nexport const AutocompleteArrayInput = (\n  props: Omit<InputProps, \"source\"> &\n    Partial<Pick<InputProps, \"source\">> &\n    ChoicesProps & {\n      className?: string;\n      disableValue?: string;\n      filterToQuery?: (searchText: string) => any;\n      translateChoice?: boolean;\n      placeholder?: string;\n      inputText?:\n        | React.ReactNode\n        | ((option: any | undefined) => React.ReactNode);\n    },\n) => {\n  const { filterToQuery = DefaultFilterToQuery, inputText } = props;\n  const {\n    allChoices = [],\n    source,\n    resource,\n    isFromReference,\n    setFilters,\n  } = useChoicesContext(props);\n  const { id, field, isRequired } = useInput({ ...props, source });\n  const translate = useTranslate();\n  const { placeholder = translate(\"ra.action.search\", { _: \"Search...\" }) } =\n    props;\n\n  const getRecordRepresentation = useGetRecordRepresentation(resource);\n  const { getChoiceText, getChoiceValue } = useChoices({\n    optionText:\n      props.optionText ?? (isFromReference ? getRecordRepresentation : \"name\"),\n    optionValue: props.optionValue ?? \"id\",\n    disableValue: props.disableValue,\n    translateChoice: props.translateChoice ?? !isFromReference,\n  });\n\n  const inputRef = React.useRef<HTMLInputElement>(null);\n  const [open, setOpen] = React.useState(false);\n\n  const handleUnselect = useEvent((choice: any) => {\n    field.onChange(\n      field.value.filter((v: any) => v !== getChoiceValue(choice)),\n    );\n  });\n\n  const handleKeyDown = useEvent((e: React.KeyboardEvent<HTMLDivElement>) => {\n    const input = inputRef.current;\n    if (input) {\n      if (e.key === \"Delete\" || e.key === \"Backspace\") {\n        if (input.value === \"\") {\n          field.onChange(field.value.slice(0, -1));\n        }\n      }\n      // This is not a default behavior of the <input /> field\n      if (e.key === \"Escape\") {\n        input.blur();\n      }\n    }\n  });\n\n  const availableChoices = allChoices.filter(\n    (choice) => !field.value.includes(getChoiceValue(choice)),\n  );\n  const selectedChoices = allChoices.filter((choice) =>\n    field.value.includes(getChoiceValue(choice)),\n  );\n  const [filterValue, setFilterValue] = React.useState(\"\");\n\n  const getInputText = useCallback(\n    (selectedChoice: any) => {\n      if (typeof inputText === \"function\") {\n        return inputText(selectedChoice);\n      }\n      if (inputText !== undefined) {\n        return inputText;\n      }\n      return getChoiceText(selectedChoice);\n    },\n    [inputText, getChoiceText],\n  );\n\n  return (\n    <FormField className={props.className} id={id} name={field.name}>\n      {props.label !== false && (\n        <FormLabel>\n          <FieldTitle\n            label={props.label}\n            source={props.source ?? source}\n            resource={resource}\n            isRequired={isRequired}\n          />\n        </FormLabel>\n      )}\n      <FormControl>\n        <Command\n          onKeyDown={handleKeyDown}\n          shouldFilter={!isFromReference}\n          className=\"overflow-visible bg-transparent\"\n        >\n          <div className=\"group rounded-md bg-transparent dark:bg-input/30 border border-input px-3 py-1.75 text-sm transition-all ring-offset-background focus-within:border-ring focus-within:ring-ring/50 focus-within:ring-[3px]\">\n            <div className=\"flex flex-wrap gap-1\">\n              {selectedChoices.map((choice) => (\n                <Badge key={getChoiceValue(choice)} variant=\"outline\">\n                  {getInputText(choice)}\n                  <button\n                    className=\"ml-1 rounded-full outline-none ring-offset-background focus:ring-2 focus:ring-ring focus:ring-offset-2\"\n                    onKeyDown={(e) => {\n                      if (e.key === \"Enter\") {\n                        handleUnselect(choice);\n                      }\n                    }}\n                    onMouseDown={(e) => {\n                      e.preventDefault();\n                      e.stopPropagation();\n                    }}\n                    onClick={(e) => {\n                      e.preventDefault();\n                      handleUnselect(choice);\n                    }}\n                  >\n                    <span className=\"sr-only\">\n                      {translate(\"ra.action.remove\", {\n                        _: \"Remove\",\n                      })}\n                    </span>\n                    <X className=\"h-3 w-3\" />\n                  </button>\n                </Badge>\n              ))}\n              {/* Avoid having the \"Search\" Icon by not using CommandInput */}\n              <CommandPrimitive.Input\n                ref={inputRef}\n                value={filterValue}\n                onValueChange={(filter) => {\n                  setFilterValue(filter);\n                  // We don't want the ChoicesContext to filter the choices if the input\n                  // is not from a reference as it would also filter out the selected values\n                  if (isFromReference) {\n                    setFilters(filterToQuery(filter), undefined, true);\n                  }\n                }}\n                onBlur={() => setOpen(false)}\n                onFocus={() => setOpen(true)}\n                placeholder={placeholder}\n                className=\"ml-2 flex-1 bg-transparent outline-none placeholder:text-muted-foreground\"\n              />\n            </div>\n          </div>\n          <div className=\"relative\">\n            <CommandList>\n              {open && availableChoices.length > 0 ? (\n                <div className=\"absolute top-2 z-10 w-full rounded-md border bg-popover text-popover-foreground shadow-md outline-none animate-in\">\n                  <CommandGroup className=\"h-full overflow-auto\">\n                    {availableChoices.map((choice) => {\n                      return (\n                        <CommandItem\n                          key={getChoiceValue(choice)}\n                          onMouseDown={(e) => {\n                            e.preventDefault();\n                            e.stopPropagation();\n                          }}\n                          onSelect={() => {\n                            setFilterValue(\"\");\n                            if (isFromReference) {\n                              setFilters(filterToQuery(\"\"));\n                            }\n                            field.onChange([\n                              ...field.value,\n                              getChoiceValue(choice),\n                            ]);\n                          }}\n                          className=\"cursor-pointer\"\n                        >\n                          {getChoiceText(choice)}\n                        </CommandItem>\n                      );\n                    })}\n                  </CommandGroup>\n                </div>\n              ) : null}\n            </CommandList>\n          </div>\n        </Command>\n      </FormControl>\n      <InputHelperText helperText={props.helperText} />\n      <FormError />\n    </FormField>\n  );\n};\n\nconst DefaultFilterToQuery = (searchText: string) => ({ q: searchText });\n","import * as React from \"react\";\nimport type { ReactElement } from \"react\";\nimport type { InputProps, UseReferenceArrayInputParams } from \"ra-core\";\nimport {\n  useReferenceArrayInputController,\n  ResourceContextProvider,\n  ChoicesContextProvider,\n} from \"ra-core\";\nimport { AutocompleteArrayInput } from \"@/components/admin/autocomplete-array-input\";\n\n/**\n * Form input for editing arrays of foreign key relationships with autocompletion.\n *\n * This component fetches related records from a reference resource and displays them\n * in a searchable multi-select interface using AutocompleteArrayInput.\n * Use it to edit one-to-many or many-to-many relationships, where the current record\n * has an array of foreign keys to another resource.\n *\n * @see {@link https://marmelab.com/shadcn-admin-kit/docs/referencearrayinput/ ReferenceArrayInput documentation}\n *\n * @example\n * import { Edit, SimpleForm, TextInput, ReferenceArrayInput } from '@/components/admin';\n *\n * const PostEdit = () => (\n *   <Edit>\n *     <SimpleForm>\n *       <TextInput source=\"title\" />\n *       <ReferenceArrayInput source=\"tag_ids\" reference=\"tags\" />\n *     </SimpleForm>\n *   </Edit>\n * );\n */\nexport const ReferenceArrayInput = (props: ReferenceArrayInputProps) => {\n  const {\n    children = defaultChildren,\n    reference,\n    sort,\n    filter = defaultFilter,\n  } = props;\n  if (React.Children.count(children) !== 1) {\n    throw new Error(\n      \"<ReferenceArrayInput> only accepts a single child (like <AutocompleteArrayInput>)\",\n    );\n  }\n\n  const controllerProps = useReferenceArrayInputController({\n    ...props,\n    sort,\n    filter,\n  });\n\n  return (\n    <ResourceContextProvider value={reference}>\n      <ChoicesContextProvider value={controllerProps}>\n        {children}\n      </ChoicesContextProvider>\n    </ResourceContextProvider>\n  );\n};\n\nconst defaultChildren = <AutocompleteArrayInput />;\nconst defaultFilter = {};\n\nexport interface ReferenceArrayInputProps\n  extends InputProps,\n    UseReferenceArrayInputParams {\n  children?: ReactElement;\n}\n","import * as React from \"react\";\nimport { useEffect, useState } from \"react\";\nimport type { InputProps } from \"ra-core\";\nimport { FieldTitle, useInput, useResourceContext } from \"ra-core\";\nimport { FormControl, FormField, FormLabel } from \"@/components/admin/form\";\nimport { Input } from \"@/components/ui/input\";\nimport { FormError } from \"@/components/admin/form\";\nimport { InputHelperText } from \"@/components/admin/input-helper-text\";\n\n/**\n * Input component for numeric values (integers and floats) with parsing and formatting support.\n *\n * Use `<NumberInput>` for prices, quantities, counts, or any numeric field. Manages a local string\n * state internally so users can type incomplete numbers (e.g. '-' or '0.') before the value is parsed.\n * Supports min/max constraints and step increments.\n *\n * @see {@link https://marmelab.com/shadcn-admin-kit/docs/numberinput/ NumberInput documentation}\n *\n * @example\n * import { Edit, SimpleForm, NumberInput, TextInput } from '@/components/admin';\n *\n * const ProductEdit = () => (\n *   <Edit>\n *     <SimpleForm>\n *       <TextInput source=\"name\" />\n *       <NumberInput source=\"price\" step={0.01} min={0} />\n *       <NumberInput source=\"quantity\" min={0} />\n *     </SimpleForm>\n *   </Edit>\n * );\n */\nexport const NumberInput = (props: NumberInputProps) => {\n  const {\n    label,\n    source,\n    className,\n    resource: resourceProp,\n    validate: _validateProp,\n    format: _formatProp,\n    parse = convertStringToNumber,\n    onFocus,\n    ...rest\n  } = props;\n  const resource = useResourceContext({ resource: resourceProp });\n\n  const { id, field, isRequired } = useInput(props);\n\n  const handleChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const value = event.target.value;\n    const numberValue = parse(value);\n\n    setValue(value);\n    field.onChange(numberValue ?? 0);\n  };\n\n  const [value, setValue] = useState<string | undefined>(\n    field.value?.toString() ?? \"\",\n  );\n\n  const hasFocus = React.useRef(false);\n\n  const handleFocus = (event: React.FocusEvent<HTMLInputElement>) => {\n    onFocus?.(event);\n    hasFocus.current = true;\n  };\n\n  const handleBlur = (event: React.FocusEvent<HTMLInputElement>) => {\n    field.onBlur?.(event);\n    hasFocus.current = false;\n    setValue(field.value?.toString() ?? \"\");\n  };\n\n  useEffect(() => {\n    if (!hasFocus.current) {\n      setValue(field.value?.toString() ?? \"\");\n    }\n  }, [field.value]);\n\n  return (\n    <FormField id={id} className={className} name={field.name}>\n      {label !== false && (\n        <FormLabel>\n          <FieldTitle\n            label={label}\n            source={source}\n            resource={resource}\n            isRequired={isRequired}\n          />\n        </FormLabel>\n      )}\n      <FormControl>\n        <Input\n          {...rest}\n          {...field}\n          type=\"number\"\n          value={value}\n          onChange={handleChange}\n          onFocus={handleFocus}\n          onBlur={handleBlur}\n        />\n      </FormControl>\n      <InputHelperText helperText={props.helperText} />\n      <FormError />\n    </FormField>\n  );\n};\n\nexport interface NumberInputProps\n  extends InputProps,\n    Omit<\n      React.ComponentProps<\"input\">,\n      \"defaultValue\" | \"onBlur\" | \"onChange\" | \"type\"\n    > {\n  parse?: (value: string) => number;\n}\n\nconst convertStringToNumber = (value?: string | null) => {\n  if (value == null || value === \"\") {\n    return null;\n  }\n  const float = parseFloat(value);\n\n  return isNaN(float) ? 0 : float;\n};\n","import { Draggable } from \"@hello-pangea/dnd\";\nimport { useRedirect } from \"ra-core\";\nimport { ReferenceField } from \"@/components/admin/reference-field\";\nimport { Card, CardContent } from \"@/components/ui/card\";\n\nimport { CompanyAvatar } from \"../companies/CompanyAvatar\";\nimport type { Deal } from \"../types\";\n\nexport const DealCard = ({ deal, index }: { deal: Deal; index: number }) => {\n  if (!deal) return null;\n\n  return (\n    <Draggable draggableId={String(deal.id)} index={index}>\n      {(provided, snapshot) => (\n        <DealCardContent provided={provided} snapshot={snapshot} deal={deal} />\n      )}\n    </Draggable>\n  );\n};\n\nexport const DealCardContent = ({\n  provided,\n  snapshot,\n  deal,\n}: {\n  provided?: any;\n  snapshot?: any;\n  deal: Deal;\n}) => {\n  const redirect = useRedirect();\n  const handleClick = () => {\n    redirect(`/deals/${deal.id}/show`, undefined, undefined, undefined, {\n      _scrollToTop: false,\n    });\n  };\n\n  return (\n    <div\n      className=\"cursor-pointer\"\n      {...provided?.draggableProps}\n      {...provided?.dragHandleProps}\n      ref={provided?.innerRef}\n      onClick={handleClick}\n    >\n      <Card\n        className={`py-4 transition-all duration-200 ${\n          snapshot?.isDragging\n            ? \"opacity-90 transform rotate-1 shadow-lg\"\n            : \"shadow-sm hover:shadow-md\"\n        }`}\n      >\n        <CardContent className=\"px-4 flex\">\n          <ReferenceField\n            source=\"company_id\"\n            record={deal}\n            reference=\"companies\"\n            link={false}\n          >\n            <CompanyAvatar width={20} height={20} />\n          </ReferenceField>\n          <div className=\"ml-3\">\n            <p className=\"text-sm font-medium mb-2\">{deal.name}</p>\n            <p className=\"text-xs text-muted-foreground\">\n              {deal.amount.toLocaleString(\"en-US\", {\n                notation: \"compact\",\n                style: \"currency\",\n                currency: \"USD\",\n                currencyDisplay: \"narrowSymbol\",\n                minimumSignificantDigits: 3,\n              })}\n              {deal.category ? `, ${deal.category}` : \"\"}\n            </p>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n};\n","/* eslint-disable react-refresh/only-export-components */\nimport { useGetIdentity, useGetList } from \"ra-core\";\nimport { useEffect, useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Dialog, DialogContent, DialogTitle } from \"@/components/ui/dialog\";\n\nimport type { Deal } from \"../types\";\nimport { DealCardContent } from \"./DealCard\";\n\nexport const DealArchivedList = () => {\n  const { identity } = useGetIdentity();\n  const {\n    data: archivedLists,\n    total,\n    isPending,\n  } = useGetList(\"deals\", {\n    pagination: { page: 1, perPage: 1000 },\n    sort: { field: \"archived_at\", order: \"DESC\" },\n    filter: { \"archived_at@not.is\": null },\n  });\n  const [openDialog, setOpenDialog] = useState(false);\n\n  useEffect(() => {\n    if (!isPending && total === 0) {\n      setOpenDialog(false);\n    }\n  }, [isPending, total]);\n\n  useEffect(() => {\n    setOpenDialog(false);\n  }, [archivedLists]);\n\n  if (!identity || isPending || !total || !archivedLists) return null;\n\n  // Group archived lists by date\n  const archivedListsByDate: { [date: string]: Deal[] } = archivedLists.reduce(\n    (acc, deal) => {\n      const date = new Date(deal.archived_at).toDateString();\n      if (!acc[date]) {\n        acc[date] = [];\n      }\n      acc[date].push(deal);\n      return acc;\n    },\n    {} as { [date: string]: Deal[] },\n  );\n\n  return (\n    <div className=\"w-full flex flex-row items-center justify-center\">\n      <Button\n        variant=\"ghost\"\n        onClick={() => setOpenDialog(true)}\n        className=\"my-4\"\n      >\n        View archived deals\n      </Button>\n      <Dialog open={openDialog} onOpenChange={() => setOpenDialog(false)}>\n        <DialogContent className=\"lg:max-w-4xl overflow-y-auto max-h-9/10 top-1/20 translate-y-0\">\n          <DialogTitle>Archived Deals</DialogTitle>\n          <div className=\"flex flex-col gap-8\">\n            {Object.entries(archivedListsByDate).map(([date, deals]) => (\n              <div key={date} className=\"flex flex-col gap-4\">\n                <h4 className=\"font-bold\">{getRelativeTimeString(date)}</h4>\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-8\">\n                  {deals.map((deal: Deal) => (\n                    <div key={deal.id}>\n                      <DealCardContent deal={deal} />\n                    </div>\n                  ))}\n                </div>\n              </div>\n            ))}\n          </div>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n};\n\nexport function getRelativeTimeString(dateString: string): string {\n  const date = new Date(dateString);\n  date.setHours(0, 0, 0, 0);\n\n  const today = new Date();\n  today.setHours(0, 0, 0, 0);\n\n  const diff = date.getTime() - today.getTime();\n  const unitDiff = Math.round(diff / (1000 * 60 * 60 * 24));\n\n  // Check if the date is more than one week old\n  if (Math.abs(unitDiff) > 7) {\n    return new Intl.DateTimeFormat(undefined, {\n      day: \"numeric\",\n      month: \"long\",\n    }).format(date);\n  }\n\n  // Intl.RelativeTimeFormat for dates within the last week\n  const rtf = new Intl.RelativeTimeFormat(undefined, { numeric: \"auto\" });\n  return ucFirst(rtf.format(unitDiff, \"day\"));\n}\n\nfunction ucFirst(str: string): string {\n  return str.charAt(0).toUpperCase() + str.slice(1);\n}\n","import * as React from \"react\"\nimport * as VisuallyHiddenPrimitive from \"@radix-ui/react-visually-hidden\"\n\nfunction VisuallyHidden({\n  ...props\n}: React.ComponentProps<typeof VisuallyHiddenPrimitive.Root>) {\n  return <VisuallyHiddenPrimitive.Root data-slot=\"visually-hidden\" {...props} />\n}\n\nexport { VisuallyHidden }\n","import { useEffect, useRef } from \"react\";\nimport { useWatch, useFormContext } from \"react-hook-form\";\nimport { required } from \"ra-core\";\nimport { AutocompleteArrayInput } from \"@/components/admin/autocomplete-array-input\";\nimport { ReferenceArrayInput } from \"@/components/admin/reference-array-input\";\nimport { ReferenceInput } from \"@/components/admin/reference-input\";\nimport { TextInput } from \"@/components/admin/text-input\";\nimport { NumberInput } from \"@/components/admin/number-input\";\nimport { DateInput } from \"@/components/admin/date-input\";\nimport { SelectInput } from \"@/components/admin/select-input\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { useIsMobile } from \"@/hooks/use-mobile\";\n\nimport { contactOptionText } from \"../misc/ContactOption\";\nimport { useConfigurationContext } from \"../root/ConfigurationContext\";\nimport { AutocompleteCompanyInput } from \"../companies/AutocompleteCompanyInput.tsx\";\n\nexport const DealInputs = () => {\n  const isMobile = useIsMobile();\n  return (\n    <div className=\"flex flex-col gap-8\">\n      <DealInfoInputs />\n\n      <div className={`flex gap-6 ${isMobile ? \"flex-col\" : \"flex-row\"}`}>\n        <DealLinkedToInputs />\n        <Separator orientation={isMobile ? \"horizontal\" : \"vertical\"} />\n        <DealMiscInputs />\n      </div>\n    </div>\n  );\n};\n\nconst DealInfoInputs = () => {\n  return (\n    <div className=\"flex flex-col gap-4 flex-1\">\n      <TextInput\n        source=\"name\"\n        label=\"Deal name\"\n        validate={required()}\n        helperText={false}\n      />\n      <TextInput source=\"description\" multiline rows={3} helperText={false} />\n    </div>\n  );\n};\n\nconst DealLinkedToInputs = () => {\n  const company_id = useWatch({ name: \"company_id\" });\n  const { setValue } = useFormContext();\n  const previousCompanyId = useRef(company_id);\n\n  // Clear selected contacts when company changes\n  useEffect(() => {\n    if (\n      previousCompanyId.current !== undefined &&\n      previousCompanyId.current !== company_id\n    ) {\n      setValue(\"contact_ids\", []);\n    }\n    previousCompanyId.current = company_id;\n  }, [company_id, setValue]);\n\n  return (\n    <div className=\"flex flex-col gap-4 flex-1\">\n      <h3 className=\"text-base font-medium\">Linked to</h3>\n      <ReferenceInput source=\"company_id\" reference=\"companies\">\n        <AutocompleteCompanyInput validate={required()} />\n      </ReferenceInput>\n\n      <ReferenceArrayInput\n        source=\"contact_ids\"\n        reference=\"contacts_summary\"\n        filter={company_id ? { company_id } : undefined}\n      >\n        <AutocompleteArrayInput\n          label=\"Contacts\"\n          optionText={contactOptionText}\n          helperText={\n            company_id\n              ? false\n              : \"Please select a company first to see its contacts\"\n          }\n        />\n      </ReferenceArrayInput>\n    </div>\n  );\n};\n\nconst DealMiscInputs = () => {\n  const { dealStages, dealCategories } = useConfigurationContext();\n  return (\n    <div className=\"flex flex-col gap-4 flex-1\">\n      <h3 className=\"text-base font-medium\">Misc</h3>\n\n      <SelectInput\n        source=\"category\"\n        label=\"Category\"\n        choices={dealCategories.map((type) => ({\n          id: type,\n          name: type,\n        }))}\n        helperText={false}\n      />\n      <NumberInput\n        source=\"amount\"\n        defaultValue={0}\n        helperText={false}\n        validate={required()}\n      />\n      <DateInput\n        validate={required()}\n        source=\"expected_closing_date\"\n        helperText={false}\n        defaultValue={new Date().toISOString().split(\"T\")[0]}\n      />\n      <SelectInput\n        source=\"stage\"\n        choices={dealStages.map((stage) => ({\n          id: stage.value,\n          name: stage.label,\n        }))}\n        defaultValue=\"opportunity\"\n        helperText={false}\n        validate={required()}\n      />\n    </div>\n  );\n};\n","import { useQueryClient } from \"@tanstack/react-query\";\nimport {\n  Form,\n  useDataProvider,\n  useGetIdentity,\n  useListContext,\n  useRedirect,\n  type GetListResult,\n} from \"ra-core\";\nimport { Create } from \"@/components/admin/create\";\nimport { SaveButton } from \"@/components/admin/form\";\nimport { FormToolbar } from \"@/components/admin/simple-form\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { VisuallyHidden } from \"@/components/ui/visually-hidden\";\n\nimport type { Deal } from \"../types\";\nimport { DealInputs } from \"./DealInputs\";\n\nexport const DealCreate = ({ open }: { open: boolean }) => {\n  const redirect = useRedirect();\n  const dataProvider = useDataProvider();\n  const { data: allDeals } = useListContext<Deal>();\n\n  const handleClose = () => {\n    redirect(\"/deals\");\n  };\n\n  const queryClient = useQueryClient();\n\n  const onSuccess = async (deal: Deal) => {\n    if (!allDeals) {\n      redirect(\"/deals\");\n      return;\n    }\n    // increase the index of all deals in the same stage as the new deal\n    // first, get the list of deals in the same stage\n    const deals = allDeals.filter(\n      (d: Deal) => d.stage === deal.stage && d.id !== deal.id,\n    );\n    // update the actual deals in the database\n    await Promise.all(\n      deals.map(async (oldDeal) =>\n        dataProvider.update(\"deals\", {\n          id: oldDeal.id,\n          data: { index: oldDeal.index + 1 },\n          previousData: oldDeal,\n        }),\n      ),\n    );\n    // refresh the list of deals in the cache as we used dataProvider.update(),\n    // which does not update the cache\n    const dealsById = deals.reduce(\n      (acc, d) => ({\n        ...acc,\n        [d.id]: { ...d, index: d.index + 1 },\n      }),\n      {} as { [key: string]: Deal },\n    );\n    const now = Date.now();\n    queryClient.setQueriesData<GetListResult | undefined>(\n      { queryKey: [\"deals\", \"getList\"] },\n      (res) => {\n        if (!res) return res;\n        return {\n          ...res,\n          data: res.data.map((d: Deal) => dealsById[d.id] || d),\n        };\n      },\n      { updatedAt: now },\n    );\n    redirect(\"/deals\");\n  };\n\n  const { identity } = useGetIdentity();\n\n  return (\n    <Dialog open={open} onOpenChange={() => handleClose()}>\n      <DialogContent className=\"lg:max-w-4xl overflow-y-auto max-h-9/10 top-1/20 translate-y-0\">\n        <VisuallyHidden>\n          <DialogTitle>Create Deal</DialogTitle>\n          <DialogDescription>\n            Create a new deal with company, contacts, and deal information\n          </DialogDescription>\n        </VisuallyHidden>\n        <Create resource=\"deals\" mutationOptions={{ onSuccess }}>\n          <Form\n            defaultValues={{\n              sales_id: identity?.id,\n              contact_ids: [],\n              index: 0,\n            }}\n          >\n            <DealInputs />\n            <FormToolbar>\n              <SaveButton />\n            </FormToolbar>\n          </Form>\n        </Create>\n      </DialogContent>\n    </Dialog>\n  );\n};\n","import {\n  EditBase,\n  Form,\n  useNotify,\n  useRecordContext,\n  useRedirect,\n} from \"ra-core\";\nimport { Link } from \"react-router\";\nimport { DeleteButton } from \"@/components/admin/delete-button\";\nimport { ReferenceField } from \"@/components/admin/reference-field\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\n\nimport { FormToolbar } from \"../layout/FormToolbar\";\nimport { CompanyAvatar } from \"../companies/CompanyAvatar\";\nimport type { Deal } from \"../types\";\nimport { DealInputs } from \"./DealInputs\";\n\nexport const DealEdit = ({ open, id }: { open: boolean; id?: string }) => {\n  const redirect = useRedirect();\n  const notify = useNotify();\n\n  const handleClose = () => {\n    redirect(\"/deals\", undefined, undefined, undefined, {\n      _scrollToTop: false,\n    });\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={() => handleClose()}>\n      <DialogContent className=\"lg:max-w-4xl p-4 overflow-y-auto max-h-9/10 top-1/20 translate-y-0\">\n        {id ? (\n          <EditBase\n            id={id}\n            mutationMode=\"pessimistic\"\n            mutationOptions={{\n              onSuccess: () => {\n                notify(\"Deal updated\");\n                redirect(`/deals/${id}/show`, undefined, undefined, undefined, {\n                  _scrollToTop: false,\n                });\n              },\n            }}\n          >\n            <EditHeader />\n            <Form>\n              <DealInputs />\n              <FormToolbar />\n            </Form>\n          </EditBase>\n        ) : null}\n      </DialogContent>\n    </Dialog>\n  );\n};\n\nfunction EditHeader() {\n  const deal = useRecordContext<Deal>();\n  if (!deal) {\n    return null;\n  }\n\n  return (\n    <>\n      <DialogTitle className=\"pb-0\">\n        <div className=\"flex justify-between items-start mb-8\">\n          <div className=\"flex items-center gap-4\">\n            <ReferenceField source=\"company_id\" reference=\"companies\" link=\"show\">\n              <CompanyAvatar />\n            </ReferenceField>\n            <h2 className=\"text-2xl font-semibold\">Edit {deal.name} deal</h2>\n          </div>\n          <div className=\"flex gap-2 pr-12\">\n            <DeleteButton />\n            <Button asChild variant=\"outline\" className=\"h-9\">\n              <Link to={`/deals/${deal.id}/show`}>Back to deal</Link>\n            </Button>\n          </div>\n        </div>\n      </DialogTitle>\n      <DialogDescription className=\"sr-only\">\n        Edit deal information including name, company, contacts, and other details\n      </DialogDescription>\n    </>\n  );\n}\n","import { useGetList } from \"ra-core\";\nimport { matchPath, useLocation, Link } from \"react-router\";\nimport type { ReactNode } from \"react\";\nimport { CreateButton } from \"@/components/admin/create-button\";\nimport { Progress } from \"@/components/ui/progress\";\n\nimport useAppBarHeight from \"../misc/useAppBarHeight\";\nimport type { Contact } from \"../types\";\nimport { DealCreate } from \"./DealCreate\";\n\nexport const DealEmpty = ({ children }: { children?: ReactNode }) => {\n  const location = useLocation();\n  const matchCreate = matchPath(\"/deals/create\", location.pathname);\n  const appbarHeight = useAppBarHeight();\n\n  // get Contact data\n  const { data: contacts, isPending: contactsLoading } = useGetList<Contact>(\n    \"contacts\",\n    {\n      pagination: { page: 1, perPage: 1 },\n    },\n  );\n\n  if (contactsLoading) return <Progress value={50} />;\n\n  return (\n    <div\n      className=\"flex flex-col justify-center items-center gap-12\"\n      style={{\n        height: `calc(100dvh - ${appbarHeight}px)`,\n      }}\n    >\n      <img src=\"./img/empty.svg\" alt=\"No deals found\" />\n      {contacts && contacts.length > 0 ? (\n        <>\n          <div className=\"flex flex-col items-center gap-0\">\n            <h3 className=\"text-lg font-bold\">No deals found</h3>\n            <p className=\"text-sm text-center text-muted-foreground mb-4\">\n              It seems your deal list is empty.\n            </p>\n          </div>\n          <div className=\"flex space-x-8\">\n            <CreateButton label=\"Create deal\" />\n          </div>\n          <DealCreate open={!!matchCreate} />\n          {children}\n        </>\n      ) : (\n        <div className=\"flex flex-col items-center gap-0\">\n          <h3 className=\"text-lg font-bold\">No deals found</h3>\n          <p className=\"text-sm text-center text-muted-foreground mb-4\">\n            It seems your contact list is empty.\n            <br />\n            <Link to=\"/contacts/create\" className=\"hover:underline\">\n              Add your first contact\n            </Link>{\" \"}\n            before creating a deal.\n          </p>\n        </div>\n      )}\n    </div>\n  );\n};\n","import { Droppable } from \"@hello-pangea/dnd\";\n\nimport { useConfigurationContext } from \"../root/ConfigurationContext\";\nimport type { Deal } from \"../types\";\nimport { findDealLabel } from \"./deal\";\nimport { DealCard } from \"./DealCard\";\n\nexport const DealColumn = ({\n  stage,\n  deals,\n}: {\n  stage: string;\n  deals: Deal[];\n}) => {\n  const totalAmount = deals.reduce((sum, deal) => sum + deal.amount, 0);\n\n  const { dealStages } = useConfigurationContext();\n  return (\n    <div className=\"flex-1 pb-8\">\n      <div className=\"flex flex-col items-center\">\n        <h3 className=\"text-base font-medium\">\n          {findDealLabel(dealStages, stage)}\n        </h3>\n        <p className=\"text-sm text-muted-foreground\">\n          {totalAmount.toLocaleString(\"en-US\", {\n            notation: \"compact\",\n            style: \"currency\",\n            currency: \"USD\",\n            currencyDisplay: \"narrowSymbol\",\n            minimumSignificantDigits: 3,\n          })}\n        </p>\n      </div>\n      <Droppable droppableId={stage}>\n        {(droppableProvided, snapshot) => (\n          <div\n            ref={droppableProvided.innerRef}\n            {...droppableProvided.droppableProps}\n            className={`flex flex-col rounded-2xl mt-2 gap-2 ${\n              snapshot.isDraggingOver ? \"bg-muted\" : \"\"\n            }`}\n          >\n            {deals.map((deal, index) => (\n              <DealCard key={deal.id} deal={deal} index={index} />\n            ))}\n            {droppableProvided.placeholder}\n          </div>\n        )}\n      </Droppable>\n    </div>\n  );\n};\n","import type { ConfigurationContextValue } from \"../root/ConfigurationContext\";\nimport type { Deal } from \"../types\";\n\nexport type DealsByStage = Record<Deal[\"stage\"], Deal[]>;\n\nexport const getDealsByStage = (\n  unorderedDeals: Deal[],\n  dealStages: ConfigurationContextValue[\"dealStages\"],\n) => {\n  if (!dealStages) return {};\n  const dealsByStage: Record<Deal[\"stage\"], Deal[]> = unorderedDeals.reduce(\n    (acc, deal) => {\n      if (acc[deal.stage]) {\n        acc[deal.stage].push(deal);\n      }\n      return acc;\n    },\n    dealStages.reduce(\n      (obj, stage) => ({ ...obj, [stage.value]: [] }),\n      {} as Record<Deal[\"stage\"], Deal[]>,\n    ),\n  );\n  // order each column by index\n  dealStages.forEach((stage) => {\n    dealsByStage[stage.value] = dealsByStage[stage.value].sort(\n      (recordA: Deal, recordB: Deal) => recordA.index - recordB.index,\n    );\n  });\n  return dealsByStage;\n};\n","import { DragDropContext, type OnDragEndResponder } from \"@hello-pangea/dnd\";\nimport isEqual from \"lodash/isEqual\";\nimport { useDataProvider, useListContext, type DataProvider } from \"ra-core\";\nimport { useEffect, useState } from \"react\";\n\nimport { useConfigurationContext } from \"../root/ConfigurationContext\";\nimport type { Deal } from \"../types\";\nimport { DealColumn } from \"./DealColumn\";\nimport type { DealsByStage } from \"./stages\";\nimport { getDealsByStage } from \"./stages\";\n\nexport const DealListContent = () => {\n  const { dealStages } = useConfigurationContext();\n  const { data: unorderedDeals, isPending, refetch } = useListContext<Deal>();\n  const dataProvider = useDataProvider();\n\n  const [dealsByStage, setDealsByStage] = useState<DealsByStage>(\n    getDealsByStage([], dealStages),\n  );\n\n  useEffect(() => {\n    if (unorderedDeals) {\n      const newDealsByStage = getDealsByStage(unorderedDeals, dealStages);\n      if (!isEqual(newDealsByStage, dealsByStage)) {\n        setDealsByStage(newDealsByStage);\n      }\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [unorderedDeals]);\n\n  if (isPending) return null;\n\n  const onDragEnd: OnDragEndResponder = (result) => {\n    const { destination, source } = result;\n\n    if (!destination) {\n      return;\n    }\n\n    if (\n      destination.droppableId === source.droppableId &&\n      destination.index === source.index\n    ) {\n      return;\n    }\n\n    const sourceStage = source.droppableId;\n    const destinationStage = destination.droppableId;\n    const sourceDeal = dealsByStage[sourceStage][source.index]!;\n    const destinationDeal = dealsByStage[destinationStage][\n      destination.index\n    ] ?? {\n      stage: destinationStage,\n      index: undefined, // undefined if dropped after the last item\n    };\n\n    // compute local state change synchronously\n    setDealsByStage(\n      updateDealStageLocal(\n        sourceDeal,\n        { stage: sourceStage, index: source.index },\n        { stage: destinationStage, index: destination.index },\n        dealsByStage,\n      ),\n    );\n\n    // persist the changes\n    updateDealStage(sourceDeal, destinationDeal, dataProvider).then(() => {\n      refetch();\n    });\n  };\n\n  return (\n    <DragDropContext onDragEnd={onDragEnd}>\n      <div className=\"flex gap-4\">\n        {dealStages.map((stage) => (\n          <DealColumn\n            stage={stage.value}\n            deals={dealsByStage[stage.value]}\n            key={stage.value}\n          />\n        ))}\n      </div>\n    </DragDropContext>\n  );\n};\n\nconst updateDealStageLocal = (\n  sourceDeal: Deal,\n  source: { stage: string; index: number },\n  destination: {\n    stage: string;\n    index?: number; // undefined if dropped after the last item\n  },\n  dealsByStage: DealsByStage,\n) => {\n  if (source.stage === destination.stage) {\n    // moving deal inside the same column\n    const column = dealsByStage[source.stage];\n    column.splice(source.index, 1);\n    column.splice(destination.index ?? column.length + 1, 0, sourceDeal);\n    return {\n      ...dealsByStage,\n      [destination.stage]: column,\n    };\n  } else {\n    // moving deal across columns\n    const sourceColumn = dealsByStage[source.stage];\n    const destinationColumn = dealsByStage[destination.stage];\n    sourceColumn.splice(source.index, 1);\n    destinationColumn.splice(\n      destination.index ?? destinationColumn.length + 1,\n      0,\n      sourceDeal,\n    );\n    return {\n      ...dealsByStage,\n      [source.stage]: sourceColumn,\n      [destination.stage]: destinationColumn,\n    };\n  }\n};\n\nconst updateDealStage = async (\n  source: Deal,\n  destination: {\n    stage: string;\n    index?: number; // undefined if dropped after the last item\n  },\n  dataProvider: DataProvider,\n) => {\n  if (source.stage === destination.stage) {\n    // moving deal inside the same column\n    // Fetch all the deals in this stage (because the list may be filtered, but we need to update even non-filtered deals)\n    const { data: columnDeals } = await dataProvider.getList(\"deals\", {\n      sort: { field: \"index\", order: \"ASC\" },\n      pagination: { page: 1, perPage: 100 },\n      filter: { stage: source.stage },\n    });\n    const destinationIndex = destination.index ?? columnDeals.length + 1;\n\n    if (source.index > destinationIndex) {\n      // deal moved up, eg\n      // dest   src\n      //  <------\n      // [4, 7, 23, 5]\n      await Promise.all([\n        // for all deals between destinationIndex and source.index, increase the index\n        ...columnDeals\n          .filter(\n            (deal) =>\n              deal.index >= destinationIndex && deal.index < source.index,\n          )\n          .map((deal) =>\n            dataProvider.update(\"deals\", {\n              id: deal.id,\n              data: { index: deal.index + 1 },\n              previousData: deal,\n            }),\n          ),\n        // for the deal that was moved, update its index\n        dataProvider.update(\"deals\", {\n          id: source.id,\n          data: { index: destinationIndex },\n          previousData: source,\n        }),\n      ]);\n    } else {\n      // deal moved down, e.g\n      // src   dest\n      //  ------>\n      // [4, 7, 23, 5]\n      await Promise.all([\n        // for all deals between source.index and destinationIndex, decrease the index\n        ...columnDeals\n          .filter(\n            (deal) =>\n              deal.index <= destinationIndex && deal.index > source.index,\n          )\n          .map((deal) =>\n            dataProvider.update(\"deals\", {\n              id: deal.id,\n              data: { index: deal.index - 1 },\n              previousData: deal,\n            }),\n          ),\n        // for the deal that was moved, update its index\n        dataProvider.update(\"deals\", {\n          id: source.id,\n          data: { index: destinationIndex },\n          previousData: source,\n        }),\n      ]);\n    }\n  } else {\n    // moving deal across columns\n    // Fetch all the deals in both stages (because the list may be filtered, but we need to update even non-filtered deals)\n    const [{ data: sourceDeals }, { data: destinationDeals }] =\n      await Promise.all([\n        dataProvider.getList(\"deals\", {\n          sort: { field: \"index\", order: \"ASC\" },\n          pagination: { page: 1, perPage: 100 },\n          filter: { stage: source.stage },\n        }),\n        dataProvider.getList(\"deals\", {\n          sort: { field: \"index\", order: \"ASC\" },\n          pagination: { page: 1, perPage: 100 },\n          filter: { stage: destination.stage },\n        }),\n      ]);\n    const destinationIndex = destination.index ?? destinationDeals.length + 1;\n\n    await Promise.all([\n      // decrease index on the deals after the source index in the source columns\n      ...sourceDeals\n        .filter((deal) => deal.index > source.index)\n        .map((deal) =>\n          dataProvider.update(\"deals\", {\n            id: deal.id,\n            data: { index: deal.index - 1 },\n            previousData: deal,\n          }),\n        ),\n      // increase index on the deals after the destination index in the destination columns\n      ...destinationDeals\n        .filter((deal) => deal.index >= destinationIndex)\n        .map((deal) =>\n          dataProvider.update(\"deals\", {\n            id: deal.id,\n            data: { index: deal.index + 1 },\n            previousData: deal,\n          }),\n        ),\n      // change the dragged deal to take the destination index and column\n      dataProvider.update(\"deals\", {\n        id: source.id,\n        data: {\n          index: destinationIndex,\n          stage: destination.stage,\n        },\n        previousData: source,\n      }),\n    ]);\n  }\n};\n","import { useGetIdentity, useListFilterContext } from \"ra-core\";\nimport { Label } from \"@/components/ui/label\";\nimport { Switch } from \"@/components/ui/switch\";\n\nexport const OnlyMineInput = (_: { alwaysOn: boolean; source: string }) => {\n  const { filterValues, displayedFilters, setFilters } = useListFilterContext();\n  const { identity } = useGetIdentity();\n\n  const handleChange = () => {\n    const newFilterValues = { ...filterValues };\n    if (typeof filterValues.sales_id !== \"undefined\") {\n      delete newFilterValues.sales_id;\n    } else {\n      newFilterValues.sales_id = identity && identity?.id;\n    }\n    setFilters(newFilterValues, displayedFilters);\n  };\n  return (\n    <div className=\"mt-auto pb-2.25\">\n      <div className=\"flex items-center space-x-2\">\n        <Switch\n          id=\"only-mine\"\n          checked={typeof filterValues.sales_id !== \"undefined\"}\n          onCheckedChange={handleChange}\n        />\n        <Label htmlFor=\"only-mine\">Only companies I manage</Label>\n      </div>\n    </div>\n  );\n};\n","import { useGetIdentity, useListContext } from \"ra-core\";\nimport { matchPath, useLocation } from \"react-router\";\nimport { AutocompleteInput } from \"@/components/admin/autocomplete-input\";\nimport { CreateButton } from \"@/components/admin/create-button\";\nimport { ExportButton } from \"@/components/admin/export-button\";\nimport { List } from \"@/components/admin/list\";\nimport { ReferenceInput } from \"@/components/admin/reference-input\";\nimport { FilterButton } from \"@/components/admin/filter-form\";\nimport { SearchInput } from \"@/components/admin/search-input\";\nimport { SelectInput } from \"@/components/admin/select-input\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Card } from \"@/components/ui/card\";\n\nimport { useConfigurationContext } from \"../root/ConfigurationContext\";\nimport { TopToolbar } from \"../layout/TopToolbar\";\nimport { DealArchivedList } from \"./DealArchivedList\";\nimport { DealCreate } from \"./DealCreate\";\nimport { DealEdit } from \"./DealEdit\";\nimport { DealEmpty } from \"./DealEmpty\";\nimport { DealListContent } from \"./DealListContent\";\nimport { OnlyMineInput } from \"./OnlyMineInput\";\n\nconst DealList = () => {\n  const { dealCategories } = useConfigurationContext();\n\n  const dealFilters = [\n    <SearchInput source=\"q\" alwaysOn />,\n    <ReferenceInput source=\"company_id\" reference=\"companies\">\n      <AutocompleteInput label={false} placeholder=\"Company\" />\n    </ReferenceInput>,\n    <SelectInput\n      source=\"category\"\n      emptyText=\"Category\"\n      choices={dealCategories.map((type) => ({ id: type, name: type }))}\n    />,\n    <OnlyMineInput source=\"sales_id\" alwaysOn />,\n  ];\n\n  return (\n    <List\n      perPage={100}\n      filter={{ \"archived_at@is\": null }}\n      title={false}\n      sort={{ field: \"index\", order: \"DESC\" }}\n      filters={dealFilters}\n      actions={<DealActions />}\n      pagination={null}\n    >\n      <DealLayout />\n    </List>\n  );\n};\n\nconst DealLayout = () => {\n  const location = useLocation();\n  const matchCreate = matchPath(\"/deals/create\", location.pathname);\n  const matchEdit = matchPath(\"/deals/:id\", location.pathname);\n\n  const { data, isPending, filterValues } = useListContext();\n  const { identity } = useGetIdentity();\n  const hasFilters = filterValues && Object.keys(filterValues).length > 0;\n\n  // Show loading skeleton while identity or data is loading\n  if (!identity || isPending) {\n    return (\n      <div className=\"w-full\">\n        <Card className=\"p-4\">\n          <div className=\"flex gap-4\">\n            <Skeleton className=\"h-96 w-1/4\" />\n            <Skeleton className=\"h-96 w-1/4\" />\n            <Skeleton className=\"h-96 w-1/4\" />\n            <Skeleton className=\"h-96 w-1/4\" />\n          </div>\n        </Card>\n      </div>\n    );\n  }\n\n  if (!data?.length && !hasFilters) {\n    return (\n      <>\n        <DealEmpty>\n          <DealArchivedList />\n        </DealEmpty>\n      </>\n    );\n  }\n\n  return (\n    <div className=\"w-full\">\n      <DealListContent />\n      <DealArchivedList />\n      <DealCreate open={!!matchCreate} />\n      <DealEdit open={!!matchEdit && !matchCreate} id={matchEdit?.params.id} />\n    </div>\n  );\n};\n\nconst DealActions = () => (\n  <TopToolbar>\n    <FilterButton />\n    <ExportButton />\n    <CreateButton label=\"New Deal\" />\n  </TopToolbar>\n);\n\nexport default DealList;\n"],"names":["__assign","t","s","i","n","p","__rest","e","__spreadArray","to","from","pack","l","ar","useReferenceArrayInputController","__name","props","_a","debounce","enableGetChoices","filter","_b","initialPage","_c","initialPerPage","_d","initialSort","_e","queryOptions","reference","source","getValues","useFormContext","finalSource","useWrappedSource","value","useWatch","meta","otherQueryOptions","_f","useGetManyAggregate","EmptyArray","referenceRecords","errorGetMany","isLoadingGetMany","isFetchingGetMany","isPausedGetMany","isPendingGetMany","isPlaceholderDataGetMany","refetchGetMany","_g","useReferenceParams","params","paramsModifiers","finalReferenceRecords","isGetMatchingEnabled","_h","useGetList","previousData","matchingReferences","total","pageInfo","errorGetList","isLoadingGetList","isFetchingGetList","isPausedGetList","isPendingGetList","isPlaceholderDataGetList","refetchGetMatching","finalMatchingReferences","mergeReferences","refetch","useCallback","currentSort","useMemo","ref1","ref2","res","ids","ref","AutocompleteArrayInput","filterToQuery","DefaultFilterToQuery","inputText","allChoices","resource","isFromReference","setFilters","useChoicesContext","id","field","isRequired","useInput","translate","useTranslate","placeholder","getRecordRepresentation","useGetRecordRepresentation","getChoiceText","getChoiceValue","useChoices","inputRef","React.useRef","open","setOpen","React.useState","handleUnselect","useEvent","choice","v","handleKeyDown","input","availableChoices","selectedChoices","filterValue","setFilterValue","getInputText","selectedChoice","jsxs","FormField","jsx","FormLabel","FieldTitle","FormControl","Command","Badge","X","CommandPrimitive","CommandList","CommandGroup","CommandItem","InputHelperText","FormError","searchText","ReferenceArrayInput","children","defaultChildren","sort","defaultFilter","React.Children","controllerProps","ResourceContextProvider","ChoicesContextProvider","NumberInput","label","className","resourceProp","_validateProp","_formatProp","parse","convertStringToNumber","onFocus","rest","useResourceContext","handleChange","event","numberValue","setValue","useState","hasFocus","handleFocus","handleBlur","useEffect","Input","float","DealCard","deal","index","Draggable","provided","snapshot","DealCardContent","redirect","useRedirect","handleClick","Card","CardContent","ReferenceField","CompanyAvatar","DealArchivedList","identity","useGetIdentity","archivedLists","isPending","openDialog","setOpenDialog","archivedListsByDate","acc","date","Button","Dialog","DialogContent","DialogTitle","deals","getRelativeTimeString","dateString","today","diff","unitDiff","rtf","ucFirst","str","VisuallyHidden","VisuallyHiddenPrimitive.Root","DealInputs","isMobile","useIsMobile","DealInfoInputs","DealLinkedToInputs","Separator","DealMiscInputs","TextInput","required","company_id","previousCompanyId","useRef","ReferenceInput","AutocompleteCompanyInput","contactOptionText","dealStages","dealCategories","useConfigurationContext","SelectInput","type","DateInput","stage","DealCreate","dataProvider","useDataProvider","allDeals","useListContext","handleClose","queryClient","useQueryClient","onSuccess","oldDeal","dealsById","d","now","DialogDescription","Create","Form","FormToolbar","SaveButton","DealEdit","notify","useNotify","EditBase","EditHeader","useRecordContext","Fragment","DeleteButton","Link","DealEmpty","location","useLocation","matchCreate","matchPath","appbarHeight","useAppBarHeight","contacts","contactsLoading","Progress","CreateButton","DealColumn","totalAmount","sum","findDealLabel","Droppable","droppableProvided","getDealsByStage","unorderedDeals","dealsByStage","obj","recordA","recordB","DealListContent","setDealsByStage","newDealsByStage","isEqual","onDragEnd","result","destination","sourceStage","destinationStage","sourceDeal","destinationDeal","updateDealStageLocal","updateDealStage","DragDropContext","column","sourceColumn","destinationColumn","columnDeals","destinationIndex","sourceDeals","destinationDeals","OnlyMineInput","_","filterValues","displayedFilters","useListFilterContext","newFilterValues","Switch","Label","DealList","dealFilters","SearchInput","AutocompleteInput","List","DealActions","DealLayout","matchEdit","data","hasFilters","Skeleton","TopToolbar","FilterButton","ExportButton"],"mappings":"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","x_google_ignoreList":[0]}